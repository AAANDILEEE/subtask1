final version: added comments and cleaned up code
